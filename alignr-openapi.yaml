openapi: 3.1.0
info:
  title: Alignr Job Intelligence API
  description: API for scoring jobs, identifying skill gaps, tailoring CVs, and career planning.
  version: 1.0.0
servers:
  - url: https://alignr-api.onrender.com
paths:
  /health:
    get:
      operationId: healthCheck
      summary: Health check
      responses:
        "200":
          description: API is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string

  /score-job:
    post:
      operationId: scoreJob
      summary: Score job match based on user skills
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_skills:
                  type: array
                  items:
                    type: string
                job_description:
                  type: string
      responses:
        "200":
          description: Job match score and skill comparison
          content:
            application/json:
              schema:
                type: object
                properties:
                  score:
                    type: integer
                  matched_skills:
                    type: array
                    items:
                      type: string
                  missing_skills:
                    type: array
                    items:
                      type: string
                  notes:
                    type: string

  /skills-gap:
    post:
      operationId: getSkillsGap
      summary: Recommend courses to close skill gaps
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties: {}   # ✅ FIX — now explicitly declares properties
      responses:
        "200":
          description: Skills and course recommendations
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_title:
                    type: string
                  skills_to_develop:
                    type: array
                    items:
                      type: object
                      properties:
                        skill:
                          type: string
                        why_needed:
                          type: string
                        how_to_evidence:
                          type: string
                        recommended_course:
                          type: object
                          properties:
                            name:
                              type: string
                            provider:
                              type: string
                            duration:
                              type: string
                            hours_per_week:
                              type: integer

  /cv-feedback:
    post:
      operationId: getCvFeedback
      summary: Provide CV improvement suggestions
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                cv_text:
                  type: string
      responses:
        "200":
          description: CV feedback and questions
          content:
            application/json:
              schema:
                type: object
                properties:
                  feedback_points:
                    type: array
                    items:
                      type: string
                  prompt_questions:
                    type: array
                    items:
                      type: string

  /guidance-intake:
    post:
      operationId: guidanceIntake
      summary: Intake user goal and suggest next step
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                goal:
                  type: string
      responses:
        "200":
          description: Next step based on goal
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  next_step:
                    type: string

  /career-quiz:
    post:
      operationId: runCareerQuiz
      summary: Personality-based career suggestion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                answers:
                  type: array
                  items:
                    type: string
      responses:
        "200":
          description: Suggested careers based on quiz
          content:
            application/json:
              schema:
                type: object
                properties:
                  personality_summary:
                    type: string
                  career_suggestion:
                    type: string
                  next_step:
                    type: string

  /career-discovery:
    post:
      operationId: discoverCareers
      summary: Suggest careers and SWOT based on profile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                personality:
                  type: array
                  items:
                    type: string
                interests:
                  type: array
                  items:
                    type: string
                skills:
                  type: array
                  items:
                    type: string
      responses:
        "200":
          description: SWOT and career suggestions
          content:
            application/json:
              schema:
                type: object
                properties:
                  suggested_careers:
                    type: array
                    items:
                      type: string
                  swot_summary:
                    type: object
                    properties:
                      strengths:
                        type: array
                        items:
                          type: string
                      weaknesses:
                        type: array
                        items:
                          type: string
                      opportunities:
                        type: array
                        items:
                          type: string
                      threats:
                        type: array
                        items:
                          type: string

  /career-plan:
    post:
      operationId: careerPlan
      summary: Create learning plan based on career goals
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                goal_role:
                  type: string
                current_skills:
                  type: array
                  items:
                    type: string
                required_skills:
                  type: array
                  items:
                    type: string
      responses:
        "200":
          description: Career learning plan
          content:
            application/json:
              schema:
                type: object
                properties:
                  goal_role:
                    type: string
                  missing_skills:
                    type: array
                    items:
                      type: string
                  timeline_estimate_weeks:
                    type: integer
                  step_by_step_plan:
                    type: array
                    items:
                      type: object
                      properties:
                        skill:
                          type: string
                  final_step:
                    type: string

  /job-level-validation:
    post:
      operationId: validateJobLevel
      summary: Suggest job level based on experience
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                skills:
                  type: array
                  items:
                    type: string
                experience_years:
                  type: integer
      responses:
        "200":
          description: Suggested job level and advice
          content:
            application/json:
              schema:
                type: object
                properties:
                  suggested_level:
                    type: string
                  reason:
                    type: string
                  suggestions:
                    type: array
                    items:
                      type: string

